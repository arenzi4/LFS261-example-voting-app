pipeline {
    agent any 
    tools{
    	nodejs 'NodeJS 22.4.0'
    }
// cuando hay cambios
    stages{
        stage("build"){
        	when{
        		changeset "**/result/**"
        	}
            steps{
            	echo 'Building app'
            	dir('result'){
            		sh 'npm install'
            	}
            }
        }
        stage("test"){
                when{
        		changeset "**/result/**"
        	}
            steps{
                 echo 'Testing app'
                 dir('result'){
                 	sh 'npm i'
                 	sh 'npm test'
                 }
            }
        }
    }       
    post{         

        always{      

             echo 'This pipeline is completed.'
             slackSend (channel: "#result-commits", message: "Pipeline execution complete: ${env.JOB_NAME} ${env.BUILD_NUMBER}")
        }
    }
}
